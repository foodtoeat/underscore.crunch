/*
    Underscore Plus
    Extension tols for underscore
    (c) 2014 Ashwin Hamal, FoodtoEat
    Underscore Plus may be freely distributed under the MIT license
*/
(function(e,n){"function"==typeof define&&define.amd?define(["underscore"],n):"object"==typeof exports?module.exports=n(require("underscore")):n(e._)})(this,function(e){var n=e.crunch=function(c){return function(o){var r={success:e.after(c.length,e.isFunction(o.success)?o.success:function(){}),error:e.once(c.error,e.isFunction(o.error)?o.success:function(){}),complete:e.after(c.length,e.isFunction(o.complete)?o.complete:function(){})};e.each(c,function(c){e.isFunction(c)?c(r):e.isArray(c.pre)&&e.isArray(c.post)?(r.complete=e.after(2,r.complete),n(c.pre).call(void 0,e.extend({},r,{success:function(){n(c.post).call(void 0,r)},error:function(){r.error(),r.complete()},complete:function(){r.complete()}}))):console.error("Invalid structure")})}};return e});