/*
    Underscore Plus
    Extension tols for underscore
    (c) 2014 Ashwin Hamal, FoodtoEat
    Underscore Plus may be freely distributed under the MIT license
*/
(function(e,n){"function"==typeof define&&define.amd?define(["underscore"],n):"object"==typeof exports?module.exports=n(require("underscore")):n(e._)})(this,function(e){var n=e.crunch=function(o){return function(r){var c={success:e.after(o.length,e.isFunction(r.success)?r.success:function(){}),error:e.once(e.isFunction(r.error)?r.error:function(){}),complete:e.after(o.length,e.isFunction(r.complete)?r.complete:function(){})};e.each(o,function(o){e.isFunction(o)?o(c):e.isArray(o.pre)&&e.isArray(o.post)?(c.complete=e.after(2,c.complete),n(o.pre).call(void 0,e.extend({},c,{success:function(){n(o.post).call(void 0,c)},error:function(){c.error(),c.complete()},complete:function(){c.complete()}}))):console.error("Invalid structure")})}};return e});