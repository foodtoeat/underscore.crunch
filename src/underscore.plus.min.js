/*
    Underscore Plus
    Extension tols for underscore
    (c) 2014 Ashwin Hamal, FoodtoEat
    Underscore Plus may be freely distributed under the MIT license
*/
(function(e,n){"function"==typeof define&&define.amd?define(["underscore"],n):"object"==typeof exports?module.exports=n(require("underscore")):n(e._)})(this,function(e){var n=e.crunch=function(c){return function(o){var r={success:e.after(c.length,e.isFunction(o.success)?o.success:function(){}),error:e.once(c.error,e.isFunction(o.error)?o.success:function(){}),complete:e.after(c.complete,e.isFunction(o.complete)?o.complete:function(){})};e.each(c,function(c){if(e.isFunction(c))c(r);else if(e.isArray(c.pre)&&e.isArray(c.post)){var o=e.extend({},r,{complete:e.after(2,r.complete)});n(c.pre).call(void 0,e.extend({},o,{success:function(){n(c.post).call(void 0,o)}}))}else console.error("Invalid structure")})}};return e});